{"ast":null,"code":"import _toConsumableArray from \"/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _defineProperty from \"/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"style\"],\n    _excluded2 = [\"src\", \"alt\", \"srcSet\", \"sizes\", \"style\"],\n    _excluded3 = [\"style\"],\n    _excluded4 = [\"style\"],\n    _excluded5 = [\"layoutOptions\", \"renderColumnContainer\", \"children\", \"columnContainerProps\"],\n    _excluded6 = [\"style\"];\nimport { jsx, Fragment } from 'react/jsx-runtime';\nimport { useLayoutEffect as useLayoutEffect$1, useEffect, useRef, useCallback, useState } from 'react';\n\nvar ratio = function ratio(_ref) {\n  var width = _ref.width,\n      height = _ref.height;\n  return width / height;\n};\n\nvar round = function round(value) {\n  var decimals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var factor = Math.pow(10, decimals);\n  return Math.round((value + Number.EPSILON) * factor) / factor;\n};\n\nvar RankingFunctionComparator = function RankingFunctionComparator(rank) {\n  return function (a, b) {\n    return rank(b) - rank(a);\n  };\n};\n\nvar MinHeap = function MinHeap(comparator) {\n  var heap = [];\n  var compare = comparator;\n  var n = 0;\n\n  var greater = function greater(i, j) {\n    return compare(heap[i], heap[j]) < 0;\n  };\n\n  var swap = function swap(i, j) {\n    var temp = heap[i];\n    heap[i] = heap[j];\n    heap[j] = temp;\n  };\n\n  var swim = function swim(k) {\n    var k2 = k >> 1;\n\n    while (k > 1 && greater(k2, k)) {\n      swap(k2, k);\n      k = k2;\n      k2 = k >> 1;\n    }\n  };\n\n  var sink = function sink(k) {\n    var j = k << 1;\n\n    while (j <= n) {\n      if (j < n && greater(j, j + 1)) j++;\n      if (!greater(k, j)) break;\n      swap(k, j);\n      k = j;\n      j = k << 1;\n    }\n  };\n\n  return {\n    push: function push(element) {\n      n += 1;\n      heap[n] = element;\n      swim(n);\n    },\n    pop: function pop() {\n      if (n === 0) return undefined;\n      swap(1, n);\n      n -= 1;\n      var max = heap.pop();\n      sink(1);\n      return max;\n    },\n    size: function size() {\n      return n;\n    }\n  };\n};\n\nvar buildPrecedentsMap = function buildPrecedentsMap(graph, startNode, endNode) {\n  var precedentsMap = {};\n  var visited = {};\n  var storedShortestPaths = {};\n  storedShortestPaths[startNode] = 0;\n  var pQueue = MinHeap(RankingFunctionComparator(function (el) {\n    return el.weight;\n  }));\n  pQueue.push({\n    id: startNode,\n    weight: 0\n  });\n  var shortestNode;\n\n  while ((shortestNode = pQueue.pop()) !== undefined) {\n    var shortestNodeId = shortestNode.id;\n    if (visited[shortestNodeId]) continue;\n    var neighboringNodes = graph(shortestNodeId);\n    visited[shortestNodeId] = 1;\n\n    for (var neighbor in neighboringNodes) {\n      var newTotalWeight = shortestNode.weight + neighboringNodes[neighbor];\n\n      if (storedShortestPaths[neighbor] === undefined || storedShortestPaths[neighbor] > newTotalWeight && (storedShortestPaths[neighbor] / newTotalWeight > 1.005 || precedentsMap[neighbor] < shortestNodeId)) {\n        storedShortestPaths[neighbor] = newTotalWeight;\n        pQueue.push({\n          id: neighbor,\n          weight: newTotalWeight\n        });\n        precedentsMap[neighbor] = shortestNodeId;\n      }\n    }\n  }\n\n  if (typeof storedShortestPaths[endNode] === \"undefined\") {\n    return undefined;\n  }\n\n  return precedentsMap;\n};\n\nvar getPathFromPrecedentsMap = function getPathFromPrecedentsMap(precedentsMap, endNode) {\n  var nodes = [];\n  var n = endNode;\n\n  while (n) {\n    nodes.push(n);\n    n = precedentsMap[n];\n  }\n\n  return nodes.reverse();\n};\n\nvar findShortestPath = function findShortestPath(graph, startNode, endNode) {\n  var precedentsMap = buildPrecedentsMap(graph, startNode, endNode);\n  return precedentsMap !== undefined ? getPathFromPrecedentsMap(precedentsMap, endNode) : undefined;\n};\n\nvar findIdealNodeSearch = function findIdealNodeSearch(_ref2) {\n  var photos = _ref2.photos,\n      targetRowHeight = _ref2.targetRowHeight,\n      containerWidth = _ref2.containerWidth;\n  var minRatio = photos.reduce(function (acc, photo) {\n    return Math.min(ratio(photo), acc);\n  }, Number.MAX_VALUE);\n  return round(containerWidth / targetRowHeight / minRatio) + 2;\n};\n\nvar getCommonHeight = function getCommonHeight(row, containerWidth, spacing, padding) {\n  var rowWidth = containerWidth - (row.length - 1) * spacing - 2 * padding * row.length;\n  var totalAspectRatio = row.reduce(function (acc, photo) {\n    return acc + ratio(photo);\n  }, 0);\n  return rowWidth / totalAspectRatio;\n};\n\nvar cost = function cost(photos, i, j, width, targetRowHeight, spacing, padding) {\n  var row = photos.slice(i, j);\n  var commonHeight = getCommonHeight(row, width, spacing, padding);\n  return commonHeight > 0 ? Math.pow(commonHeight - targetRowHeight, 2) * row.length : undefined;\n};\n\nvar makeGetNeighbors$1 = function makeGetNeighbors$1(_ref3) {\n  var photos = _ref3.photos,\n      layoutOptions = _ref3.layoutOptions,\n      targetRowHeight = _ref3.targetRowHeight,\n      limitNodeSearch = _ref3.limitNodeSearch,\n      rowConstraints = _ref3.rowConstraints,\n      instrumentation = _ref3.instrumentation;\n  return function (node) {\n    var _a, _b;\n\n    var containerWidth = layoutOptions.containerWidth,\n        spacing = layoutOptions.spacing,\n        padding = layoutOptions.padding;\n    var results = {};\n    var start = +node;\n    results[+start] = 0;\n    var startOffset = (_a = rowConstraints === null || rowConstraints === void 0 ? void 0 : rowConstraints.minPhotos) !== null && _a !== void 0 ? _a : 1;\n    var endOffset = Math.min(limitNodeSearch, (_b = rowConstraints === null || rowConstraints === void 0 ? void 0 : rowConstraints.maxPhotos) !== null && _b !== void 0 ? _b : Infinity);\n\n    for (var i = start + startOffset; i < photos.length + 1; i += 1) {\n      if (i - start > endOffset && !(instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.fullGraphSearch)) break;\n      var currentCost = cost(photos, start, i, containerWidth, targetRowHeight, spacing, padding);\n      if (currentCost === undefined) break;\n      results[i.toString()] = currentCost;\n    }\n\n    return results;\n  };\n};\n\nvar computeRowsLayout = function computeRowsLayout(_ref4) {\n  var photos = _ref4.photos,\n      layoutOptions = _ref4.layoutOptions,\n      instrumentation = _ref4.instrumentation;\n\n  var _a, _b;\n\n  var spacing = layoutOptions.spacing,\n      padding = layoutOptions.padding,\n      containerWidth = layoutOptions.containerWidth,\n      targetRowHeight = layoutOptions.targetRowHeight,\n      rowConstraints = layoutOptions.rowConstraints;\n  (_a = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _a === void 0 ? void 0 : _a.call(instrumentation);\n  var limitNodeSearch = findIdealNodeSearch({\n    photos: photos,\n    containerWidth: containerWidth,\n    targetRowHeight: targetRowHeight\n  });\n  var getNeighbors = makeGetNeighbors$1({\n    photos: photos,\n    layoutOptions: layoutOptions,\n    targetRowHeight: targetRowHeight,\n    limitNodeSearch: limitNodeSearch,\n    rowConstraints: rowConstraints,\n    instrumentation: instrumentation\n  });\n  var path = findShortestPath(getNeighbors, \"0\", \"\".concat(photos.length));\n  if (path === undefined) return undefined;\n  var result = [];\n\n  var _loop = function _loop(i) {\n    var row = photos.map(function (photo, index) {\n      return {\n        photo: photo,\n        index: index\n      };\n    }).slice(+path[i - 1], +path[i]);\n    var height = getCommonHeight(row.map(function (_ref5) {\n      var photo = _ref5.photo;\n      return photo;\n    }), containerWidth, spacing, padding);\n    result.push(row.map(function (_ref6, photoIndex) {\n      var photo = _ref6.photo,\n          index = _ref6.index;\n      return {\n        photo: photo,\n        layout: {\n          height: height,\n          width: height * ratio(photo),\n          index: index,\n          photoIndex: photoIndex,\n          photosCount: row.length\n        }\n      };\n    }));\n  };\n\n  for (var i = 1; i < path.length; i += 1) {\n    _loop(i);\n  }\n\n  (_b = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _b === void 0 ? void 0 : _b.call(instrumentation, result);\n  return result;\n};\n\nvar calcWidth = function calcWidth(base, _ref7, _ref8) {\n  var width = _ref7.width,\n      photosCount = _ref7.photosCount;\n  var spacing = _ref8.spacing,\n      padding = _ref8.padding,\n      containerWidth = _ref8.containerWidth;\n  var gaps = spacing * (photosCount - 1) + 2 * padding * photosCount;\n  return \"calc((\".concat(base, \" - \").concat(gaps, \"px) / \").concat(round((containerWidth - gaps) / width, 5), \")\");\n};\n\nvar cssWidth$1 = function cssWidth$1(layout, layoutOptions) {\n  if (layoutOptions.layout !== \"rows\") {\n    return \"calc(100% - \".concat(2 * layoutOptions.padding, \"px)\");\n  }\n\n  return calcWidth(\"100%\", layout, layoutOptions);\n};\n\nvar calculateSizesValue = function calculateSizesValue(size, layout, layoutOptions) {\n  var _a, _b;\n\n  return calcWidth((_b = (_a = size.match(/calc\\((.*)\\)/)) === null || _a === void 0 ? void 0 : _a[1]) !== null && _b !== void 0 ? _b : size, layout, layoutOptions);\n};\n\nvar srcSetAndSizes = function srcSetAndSizes(photo, layout, layoutOptions) {\n  var srcSet, sizes;\n\n  if (photo.images && photo.images.length > 0) {\n    srcSet = photo.images.concat([{\n      src: photo.src,\n      width: photo.width,\n      height: photo.height\n    }]).sort(function (first, second) {\n      return first.width - second.width;\n    }).map(function (image) {\n      return \"\".concat(image.src, \" \").concat(image.width, \"w\");\n    }).join(\", \");\n  }\n\n  if (layoutOptions.sizes) {\n    sizes = (layoutOptions.sizes.sizes || []).map(function (_ref9) {\n      var viewport = _ref9.viewport,\n          size = _ref9.size;\n      return \"\".concat(viewport, \" \").concat(calculateSizesValue(size, layout, layoutOptions));\n    }).concat(calculateSizesValue(layoutOptions.sizes.size, layout, layoutOptions)).join(\", \");\n  } else {\n    sizes = \"\".concat(Math.ceil(layout.width / (layoutOptions.viewportWidth || layoutOptions.containerWidth) * 100), \"vw\");\n  }\n\n  return {\n    srcSet: srcSet,\n    sizes: sizes\n  };\n};\n\nvar PhotoRenderer = function PhotoRenderer(props) {\n  var _a, _b;\n\n  var photo = props.photo,\n      layout = props.layout,\n      layoutOptions = props.layoutOptions,\n      _props$imageProps = props.imageProps;\n  _props$imageProps = _props$imageProps === void 0 ? {} : _props$imageProps;\n\n  var style = _props$imageProps.style,\n      restImageProps = _objectWithoutProperties(_props$imageProps, _excluded),\n      renderPhoto = props.renderPhoto;\n\n  var onClick = layoutOptions.onClick;\n\n  var imageStyle = _objectSpread(_objectSpread(_objectSpread(_objectSpread({\n    display: \"block\",\n    boxSizing: \"content-box\",\n    width: cssWidth$1(layout, layoutOptions),\n    height: \"auto\",\n    aspectRatio: \"\".concat(photo.width, \" / \").concat(photo.height)\n  }, layoutOptions.padding ? {\n    padding: \"\".concat(layoutOptions.padding, \"px\")\n  } : null), (layoutOptions.layout === \"columns\" || layoutOptions.layout === \"masonry\") && layout.photoIndex < layout.photosCount - 1 ? {\n    marginBottom: \"\".concat(layoutOptions.spacing, \"px\")\n  } : null), onClick ? {\n    cursor: \"pointer\"\n  } : null), style);\n\n  var handleClick = onClick ? function (event) {\n    onClick(event, photo, layout.index);\n  } : undefined;\n\n  var imageProps = _objectSpread(_objectSpread({\n    src: photo.src,\n    alt: (_a = photo.alt) !== null && _a !== void 0 ? _a : \"\",\n    title: photo.title,\n    onClick: handleClick,\n    style: imageStyle,\n    className: \"react-photo-album--photo\"\n  }, srcSetAndSizes(photo, layout, layoutOptions)), restImageProps);\n\n  var renderDefaultPhoto = function renderDefaultPhoto() {\n    var _ref10 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        wrapped = _ref10.wrapped;\n\n    var src = imageProps.src,\n        alt = imageProps.alt,\n        srcSet = imageProps.srcSet,\n        sizes = imageProps.sizes,\n        style = imageProps.style,\n        rest = _objectWithoutProperties(imageProps, _excluded2);\n\n    return jsx(\"img\", _objectSpread(_objectSpread({\n      alt: alt\n    }, srcSet ? {\n      srcSet: srcSet,\n      sizes: sizes\n    } : null), {}, {\n      src: src,\n      style: wrapped ? {\n        display: \"block\",\n        width: \"100%\",\n        height: \"100%\"\n      } : style\n    }, rest));\n  };\n\n  var wrapperStyle = function (_ref11) {\n    var display = _ref11.display,\n        boxSizing = _ref11.boxSizing,\n        width = _ref11.width,\n        aspectRatio = _ref11.aspectRatio,\n        padding = _ref11.padding,\n        marginBottom = _ref11.marginBottom;\n    return {\n      display: display,\n      boxSizing: boxSizing,\n      width: width,\n      aspectRatio: aspectRatio,\n      padding: padding,\n      marginBottom: marginBottom\n    };\n  }(imageStyle);\n\n  return jsx(Fragment, {\n    children: (_b = renderPhoto === null || renderPhoto === void 0 ? void 0 : renderPhoto({\n      photo: photo,\n      layout: layout,\n      layoutOptions: layoutOptions,\n      imageProps: imageProps,\n      renderDefaultPhoto: renderDefaultPhoto,\n      wrapperStyle: wrapperStyle\n    })) !== null && _b !== void 0 ? _b : renderDefaultPhoto()\n  });\n};\n\nvar defaultRenderRowContainer = function defaultRenderRowContainer(_ref12) {\n  var rowContainerProps = _ref12.rowContainerProps,\n      children = _ref12.children;\n  return jsx(\"div\", _objectSpread(_objectSpread({}, rowContainerProps), {}, {\n    children: children\n  }));\n};\n\nvar RowContainerRenderer = function RowContainerRenderer(props) {\n  var layoutOptions = props.layoutOptions,\n      rowIndex = props.rowIndex,\n      rowsCount = props.rowsCount,\n      renderRowContainer = props.renderRowContainer,\n      _props$rowContainerPr = props.rowContainerProps;\n  _props$rowContainerPr = _props$rowContainerPr === void 0 ? {} : _props$rowContainerPr;\n\n  var style = _props$rowContainerPr.style,\n      restRowContainerProps = _objectWithoutProperties(_props$rowContainerPr, _excluded3),\n      children = props.children;\n\n  var rowContainerProps = _objectSpread({\n    className: \"react-photo-album--row\",\n    style: _objectSpread(_objectSpread({\n      display: \"flex\",\n      flexDirection: \"row\",\n      flexWrap: \"nowrap\",\n      alignItems: \"flex-start\",\n      justifyContent: \"space-between\"\n    }, rowIndex < rowsCount - 1 ? {\n      marginBottom: \"\".concat(layoutOptions.spacing, \"px\")\n    } : null), style)\n  }, restRowContainerProps);\n\n  return jsx(Fragment, {\n    children: (renderRowContainer !== null && renderRowContainer !== void 0 ? renderRowContainer : defaultRenderRowContainer)({\n      layoutOptions: layoutOptions,\n      rowIndex: rowIndex,\n      rowsCount: rowsCount,\n      rowContainerProps: rowContainerProps,\n      children: children\n    })\n  });\n};\n\nvar RowsLayout = function RowsLayout(props) {\n  var photos = props.photos,\n      layoutOptions = props.layoutOptions,\n      renderPhoto = props.renderPhoto,\n      renderRowContainer = props.renderRowContainer,\n      componentsProps = props.componentsProps,\n      instrumentation = props.instrumentation;\n  var rowsLayout = computeRowsLayout({\n    photos: photos,\n    layoutOptions: layoutOptions,\n    instrumentation: instrumentation\n  });\n  if (rowsLayout === undefined) return jsx(Fragment, {});\n  return jsx(Fragment, {\n    children: rowsLayout.map(function (row, rowIndex) {\n      return jsx(RowContainerRenderer, {\n        layoutOptions: layoutOptions,\n        rowIndex: rowIndex,\n        rowsCount: rowsLayout.length,\n        renderRowContainer: renderRowContainer,\n        rowContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.rowContainerProps,\n        children: row.map(function (_ref13) {\n          var photo = _ref13.photo,\n              layout = _ref13.layout;\n          return jsx(PhotoRenderer, {\n            photo: photo,\n            layout: layout,\n            layoutOptions: layoutOptions,\n            renderPhoto: renderPhoto,\n            imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps\n          }, photo.key || photo.src);\n        })\n      }, \"row-\".concat(rowIndex));\n    })\n  });\n};\n\nvar computeShortestPath = function computeShortestPath(graph, pathLength, startNode, endNode) {\n  var comp = [];\n  var queue = {\n    0: _defineProperty({}, startNode, null)\n  };\n\n  var _loop2 = function _loop2(length) {\n    Object.keys(queue[length]).forEach(function (n) {\n      var node = +n;\n      var accumulatedWeight = length > 0 && comp[node][length] ? comp[node][length][1] : 0;\n      graph(node).forEach(function (_ref14) {\n        var neighbor = _ref14.neighbor,\n            weight = _ref14.weight;\n\n        if (!comp[neighbor]) {\n          comp[neighbor] = [];\n        }\n\n        var newTotalWeight = accumulatedWeight + weight;\n\n        if (!comp[neighbor][length + 1] || comp[neighbor][length + 1][1] > newTotalWeight && (comp[neighbor][length + 1][1] / newTotalWeight > 1.0001 || node < comp[neighbor][length + 1][0])) {\n          comp[neighbor][length + 1] = [node, newTotalWeight];\n        }\n\n        if (length < pathLength - 1 && neighbor !== endNode) {\n          if (!queue[length + 1]) {\n            queue[length + 1] = {};\n          }\n\n          queue[length + 1][neighbor] = null;\n        }\n      });\n    });\n  };\n\n  for (var length = 0; length < pathLength; length += 1) {\n    _loop2(length);\n  }\n\n  return comp;\n};\n\nvar reconstructShortestPath = function reconstructShortestPath(comp, pathLength, endNode) {\n  var path = [endNode];\n\n  for (var node = endNode, length = pathLength; length > 0; length -= 1) {\n    var _comp$node$length = _slicedToArray(comp[node][length], 1),\n        prevNode = _comp$node$length[0];\n\n    node = prevNode;\n    path.push(node);\n  }\n\n  return path.reverse();\n};\n\nvar findShortestPathLengthN = function findShortestPathLengthN(graph, pathLength, startNode, endNode) {\n  return reconstructShortestPath(computeShortestPath(graph, pathLength, startNode, endNode), pathLength, endNode);\n};\n\nvar makeGetNeighbors = function makeGetNeighbors(_ref15) {\n  var photos = _ref15.photos,\n      spacing = _ref15.spacing,\n      padding = _ref15.padding,\n      targetColumnWidth = _ref15.targetColumnWidth,\n      targetColumnHeight = _ref15.targetColumnHeight,\n      instrumentation = _ref15.instrumentation;\n  return function (node) {\n    var results = [];\n    var cutOffHeight = targetColumnHeight * 1.5;\n    var height = targetColumnWidth / ratio(photos[node]) + 2 * padding;\n\n    for (var i = node + 1; i < photos.length + 1; i += 1) {\n      results.push({\n        neighbor: i,\n        weight: Math.pow(targetColumnHeight - height, 2)\n      });\n\n      if (height > cutOffHeight && !(instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.fullGraphSearch) || i === photos.length) {\n        break;\n      }\n\n      height += targetColumnWidth / ratio(photos[i]) + spacing + 2 * padding;\n    }\n\n    return results;\n  };\n};\n\nvar buildColumnsModel = function buildColumnsModel(_ref16) {\n  var path = _ref16.path,\n      photos = _ref16.photos,\n      containerWidth = _ref16.containerWidth,\n      columnsGaps = _ref16.columnsGaps,\n      columnsRatios = _ref16.columnsRatios,\n      spacing = _ref16.spacing,\n      padding = _ref16.padding;\n  var columnsModel = [];\n  var totalRatio = columnsRatios.reduce(function (acc, ratio) {\n    return acc + ratio;\n  }, 0);\n\n  var _loop3 = function _loop3(i) {\n    var column = photos.map(function (photo, index) {\n      return {\n        photo: photo,\n        index: index\n      };\n    }).slice(path[i], path[i + 1]);\n    var totalAdjustedGaps = columnsRatios.reduce(function (acc, ratio, index) {\n      return acc + (columnsGaps[i] - columnsGaps[index]) * ratio;\n    }, 0);\n    var columnWidth = (containerWidth - (path.length - 2) * spacing - 2 * (path.length - 1) * padding - totalAdjustedGaps) * columnsRatios[i] / totalRatio;\n    columnsModel.push(column.map(function (_ref17, photoIndex) {\n      var photo = _ref17.photo,\n          index = _ref17.index;\n      return {\n        photo: photo,\n        layout: {\n          width: columnWidth,\n          height: columnWidth / ratio(photo),\n          index: index,\n          photoIndex: photoIndex,\n          photosCount: column.length\n        }\n      };\n    }));\n  };\n\n  for (var i = 0; i < path.length - 1; i += 1) {\n    _loop3(i);\n  }\n\n  return columnsModel;\n};\n\nvar computeColumnsModel = function computeColumnsModel(_ref18) {\n  var photos = _ref18.photos,\n      layoutOptions = _ref18.layoutOptions,\n      targetColumnWidth = _ref18.targetColumnWidth,\n      instrumentation = _ref18.instrumentation;\n\n  var _a;\n\n  var columns = layoutOptions.columns,\n      spacing = layoutOptions.spacing,\n      padding = layoutOptions.padding,\n      containerWidth = layoutOptions.containerWidth;\n  var columnsGaps = [];\n  var columnsRatios = [];\n\n  if (photos.length <= columns) {\n    for (var index = 0; index < photos.length; index += 1) {\n      columnsGaps[index] = 2 * padding;\n      columnsRatios[index] = ratio(photos[index]);\n    }\n\n    var _columnsModel = buildColumnsModel({\n      path: Array.from({\n        length: photos.length + 1\n      }).map(function (_, index) {\n        return index;\n      }),\n      photos: photos,\n      columnsRatios: columnsRatios,\n      columnsGaps: columnsGaps,\n      containerWidth: containerWidth,\n      spacing: spacing,\n      padding: padding\n    });\n\n    for (var i = photos.length; i < (((_a = layoutOptions.columnConstraints) === null || _a === void 0 ? void 0 : _a.minColumns) || 0); i += 1) {\n      columnsGaps[i] = 0;\n      columnsRatios[i] = photos.length > 0 ? photos.reduce(function (acc, photo) {\n        return acc + ratio(photo);\n      }, 0) / photos.length : 1;\n      _columnsModel[i] = [];\n    }\n\n    return {\n      columnsGaps: columnsGaps,\n      columnsRatios: columnsRatios,\n      columnsModel: _columnsModel\n    };\n  }\n\n  var targetColumnHeight = (photos.reduce(function (acc, photo) {\n    return acc + targetColumnWidth / ratio(photo);\n  }, 0) + spacing * (photos.length - columns) + 2 * padding * photos.length) / columns;\n  var getNeighbors = makeGetNeighbors({\n    photos: photos,\n    targetColumnWidth: targetColumnWidth,\n    targetColumnHeight: targetColumnHeight,\n    spacing: spacing,\n    padding: padding,\n    instrumentation: instrumentation\n  });\n  var path = findShortestPathLengthN(getNeighbors, columns, 0, photos.length).map(function (node) {\n    return +node;\n  });\n\n  for (var _i = 0; _i < path.length - 1; _i += 1) {\n    var column = photos.slice(path[_i], path[_i + 1]);\n    columnsGaps[_i] = spacing * (column.length - 1) + 2 * padding * column.length;\n    columnsRatios[_i] = 1 / column.reduce(function (acc, photo) {\n      return acc + 1 / ratio(photo);\n    }, 0);\n  }\n\n  var columnsModel = buildColumnsModel({\n    path: path,\n    photos: photos,\n    columnsRatios: columnsRatios,\n    columnsGaps: columnsGaps,\n    containerWidth: containerWidth,\n    spacing: spacing,\n    padding: padding\n  });\n  return {\n    columnsGaps: columnsGaps,\n    columnsRatios: columnsRatios,\n    columnsModel: columnsModel\n  };\n};\n\nvar computeLayout = function computeLayout(props) {\n  var photos = props.photos,\n      layoutOptions = props.layoutOptions,\n      instrumentation = props.instrumentation;\n  var columns = layoutOptions.columns,\n      spacing = layoutOptions.spacing,\n      padding = layoutOptions.padding,\n      containerWidth = layoutOptions.containerWidth;\n  var targetColumnWidth = (containerWidth - spacing * (columns - 1) - 2 * padding * columns) / columns;\n\n  var _computeColumnsModel = computeColumnsModel({\n    photos: photos,\n    layoutOptions: layoutOptions,\n    targetColumnWidth: targetColumnWidth,\n    instrumentation: instrumentation\n  }),\n      columnsGaps = _computeColumnsModel.columnsGaps,\n      columnsRatios = _computeColumnsModel.columnsRatios,\n      columnsModel = _computeColumnsModel.columnsModel;\n\n  if (columnsModel.findIndex(function (columnModel) {\n    return columnModel.findIndex(function (_ref19) {\n      var _ref19$layout = _ref19.layout,\n          width = _ref19$layout.width,\n          height = _ref19$layout.height;\n      return width < 0 || height < 0;\n    }) >= 0;\n  }) >= 0) {\n    if (columns > 1) {\n      return computeLayout({\n        photos: photos,\n        layoutOptions: _objectSpread(_objectSpread({}, layoutOptions), {}, {\n          columns: columns - 1\n        }),\n        instrumentation: instrumentation\n      });\n    } else {\n      return undefined;\n    }\n  }\n\n  return {\n    columnsModel: columnsModel,\n    columnsGaps: columnsGaps,\n    columnsRatios: columnsRatios\n  };\n};\n\nvar computeColumnsLayout = function computeColumnsLayout(_ref20) {\n  var photos = _ref20.photos,\n      layoutOptions = _ref20.layoutOptions,\n      instrumentation = _ref20.instrumentation;\n\n  var _a, _b, _c;\n\n  (_a = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _a === void 0 ? void 0 : _a.call(instrumentation);\n  var result = computeLayout({\n    photos: photos,\n    layoutOptions: _objectSpread(_objectSpread({}, layoutOptions), {}, {\n      columns: Math.min(layoutOptions.columns, Math.max(photos.length, ((_b = layoutOptions.columnConstraints) === null || _b === void 0 ? void 0 : _b.minColumns) || 0))\n    }),\n    instrumentation: instrumentation\n  });\n  (_c = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _c === void 0 ? void 0 : _c.call(instrumentation, result);\n  return result;\n};\n\nvar defaultRenderColumnContainer = function defaultRenderColumnContainer(_ref21) {\n  var columnContainerProps = _ref21.columnContainerProps,\n      children = _ref21.children;\n  return jsx(\"div\", _objectSpread(_objectSpread({}, columnContainerProps), {}, {\n    children: children\n  }));\n};\n\nvar cssWidth = function cssWidth(props) {\n  var layoutOptions = props.layoutOptions,\n      columnIndex = props.columnIndex,\n      columnsCount = props.columnsCount,\n      columnsGaps = props.columnsGaps,\n      columnsRatios = props.columnsRatios;\n  var layout = layoutOptions.layout,\n      spacing = layoutOptions.spacing,\n      padding = layoutOptions.padding;\n\n  if (layout === \"masonry\" || !columnsGaps || !columnsRatios) {\n    return \"calc((100% - \".concat(spacing * (columnsCount - 1), \"px) / \").concat(columnsCount, \")\");\n  }\n\n  var totalRatio = columnsRatios.reduce(function (acc, ratio) {\n    return acc + ratio;\n  }, 0);\n  var totalAdjustedGaps = columnsRatios.reduce(function (acc, ratio, index) {\n    return acc + (columnsGaps[columnIndex] - columnsGaps[index]) * ratio;\n  }, 0);\n  return \"calc((100% - \".concat(round((columnsCount - 1) * spacing + 2 * columnsCount * padding + totalAdjustedGaps, 3), \"px) * \").concat(round(columnsRatios[columnIndex] / totalRatio, 5), \" + \").concat(2 * padding, \"px)\");\n};\n\nvar ColumnContainerRenderer = function ColumnContainerRenderer(props) {\n  var layoutOptions = props.layoutOptions,\n      renderColumnContainer = props.renderColumnContainer,\n      children = props.children,\n      _props$columnContaine = props.columnContainerProps;\n  _props$columnContaine = _props$columnContaine === void 0 ? {} : _props$columnContaine;\n\n  var style = _props$columnContaine.style,\n      restColumnContainerProps = _objectWithoutProperties(_props$columnContaine, _excluded4),\n      rest = _objectWithoutProperties(props, _excluded5);\n\n  var columnContainerProps = _objectSpread({\n    className: \"react-photo-album--column\",\n    style: _objectSpread({\n      display: \"flex\",\n      flexDirection: \"column\",\n      flexWrap: \"nowrap\",\n      alignItems: \"flex-start\",\n      width: cssWidth(props),\n      justifyContent: layoutOptions.layout === \"columns\" ? \"space-between\" : \"flex-start\"\n    }, style)\n  }, restColumnContainerProps);\n\n  return jsx(Fragment, {\n    children: (renderColumnContainer !== null && renderColumnContainer !== void 0 ? renderColumnContainer : defaultRenderColumnContainer)(_objectSpread({\n      layoutOptions: layoutOptions,\n      columnContainerProps: columnContainerProps,\n      children: children\n    }, rest))\n  });\n};\n\nvar ColumnsLayout = function ColumnsLayout(props) {\n  var photos = props.photos,\n      layoutOptions = props.layoutOptions,\n      renderPhoto = props.renderPhoto,\n      renderColumnContainer = props.renderColumnContainer,\n      componentsProps = props.componentsProps,\n      instrumentation = props.instrumentation;\n  var columnsLayout = computeColumnsLayout({\n    photos: photos,\n    layoutOptions: layoutOptions,\n    instrumentation: instrumentation\n  });\n  if (columnsLayout === undefined) return jsx(Fragment, {});\n  var columnsModel = columnsLayout.columnsModel,\n      columnsRatios = columnsLayout.columnsRatios,\n      columnsGaps = columnsLayout.columnsGaps;\n  return jsx(Fragment, {\n    children: columnsModel.map(function (column, columnIndex) {\n      return jsx(ColumnContainerRenderer, {\n        layoutOptions: layoutOptions,\n        columnIndex: columnIndex,\n        columnsCount: columnsModel.length,\n        columnsGaps: columnsGaps,\n        columnsRatios: columnsRatios,\n        renderColumnContainer: renderColumnContainer,\n        columnContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.columnContainerProps,\n        children: column.map(function (_ref22) {\n          var photo = _ref22.photo,\n              layout = _ref22.layout;\n          return jsx(PhotoRenderer, {\n            photo: photo,\n            layout: layout,\n            layoutOptions: layoutOptions,\n            renderPhoto: renderPhoto,\n            imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps\n          }, photo.key || photo.src);\n        })\n      }, \"column-\".concat(columnIndex));\n    })\n  });\n};\n\nvar computeMasonryLayout = function computeMasonryLayout(props) {\n  var _a, _b, _c;\n\n  var photos = props.photos,\n      layoutOptions = props.layoutOptions,\n      instrumentation = props.instrumentation;\n  var spacing = layoutOptions.spacing,\n      padding = layoutOptions.padding,\n      containerWidth = layoutOptions.containerWidth;\n  var columns = Math.min(layoutOptions.columns, Math.max(photos.length, ((_a = layoutOptions.columnConstraints) === null || _a === void 0 ? void 0 : _a.minColumns) || 0));\n  (_b = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _b === void 0 ? void 0 : _b.call(instrumentation);\n  var columnWidth = (containerWidth - spacing * (columns - 1) - 2 * padding * columns) / columns;\n\n  if (columnWidth <= 0) {\n    return columns > 1 ? computeMasonryLayout(_objectSpread(_objectSpread({}, props), {}, {\n      layoutOptions: _objectSpread(_objectSpread({}, layoutOptions), {}, {\n        columns: columns - 1\n      })\n    })) : undefined;\n  }\n\n  var columnsCurrentTopPositions = [];\n\n  for (var i = 0; i < columns; i += 1) {\n    columnsCurrentTopPositions[i] = 0;\n  }\n\n  var columnsModel = photos.reduce(function (acc, photo, index) {\n    var shortestColumn = columnsCurrentTopPositions.reduce(function (acc, item, i) {\n      return item < columnsCurrentTopPositions[acc] - 1 ? i : acc;\n    }, 0);\n    columnsCurrentTopPositions[shortestColumn] = columnsCurrentTopPositions[shortestColumn] + columnWidth / ratio(photo) + spacing + 2 * padding;\n    acc[shortestColumn].push({\n      photo: photo,\n      index: index\n    });\n    return acc;\n  }, Array.from({\n    length: columns\n  }).map(function () {\n    return [];\n  }));\n  var result = columnsModel.map(function (column) {\n    return column.map(function (_ref23, photoIndex) {\n      var photo = _ref23.photo,\n          index = _ref23.index;\n      return {\n        photo: photo,\n        layout: {\n          width: columnWidth,\n          height: columnWidth / ratio(photo),\n          index: index,\n          photoIndex: photoIndex,\n          photosCount: column.length\n        }\n      };\n    });\n  });\n  (_c = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _c === void 0 ? void 0 : _c.call(instrumentation, result);\n  return result;\n};\n\nvar MasonryLayout = function MasonryLayout(props) {\n  var photos = props.photos,\n      layoutOptions = props.layoutOptions,\n      renderPhoto = props.renderPhoto,\n      renderColumnContainer = props.renderColumnContainer,\n      componentsProps = props.componentsProps,\n      instrumentation = props.instrumentation;\n  var masonryLayout = computeMasonryLayout({\n    photos: photos,\n    layoutOptions: layoutOptions,\n    instrumentation: instrumentation\n  });\n  if (masonryLayout === undefined) return jsx(Fragment, {});\n  return jsx(Fragment, {\n    children: masonryLayout.map(function (column, columnIndex) {\n      return jsx(ColumnContainerRenderer, {\n        layoutOptions: layoutOptions,\n        columnsCount: masonryLayout.length,\n        columnIndex: columnIndex,\n        renderColumnContainer: renderColumnContainer,\n        columnContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.columnContainerProps,\n        children: column.map(function (_ref24) {\n          var photo = _ref24.photo,\n              layout = _ref24.layout;\n          return jsx(PhotoRenderer, {\n            photo: photo,\n            layout: layout,\n            layoutOptions: layoutOptions,\n            renderPhoto: renderPhoto,\n            imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps\n          }, photo.key || photo.src);\n        })\n      }, \"masonry-column-\".concat(columnIndex));\n    })\n  });\n};\n\nvar defaultRenderContainer = function defaultRenderContainer(_ref25) {\n  var containerProps = _ref25.containerProps,\n      children = _ref25.children,\n      containerRef = _ref25.containerRef;\n  return jsx(\"div\", _objectSpread(_objectSpread({\n    ref: containerRef\n  }, containerProps), {}, {\n    children: children\n  }));\n};\n\nvar ContainerRenderer = function ContainerRenderer(props) {\n  var layoutOptions = props.layoutOptions,\n      renderContainer = props.renderContainer,\n      children = props.children,\n      containerRef = props.containerRef,\n      _props$containerProps = props.containerProps;\n  _props$containerProps = _props$containerProps === void 0 ? {} : _props$containerProps;\n\n  var style = _props$containerProps.style,\n      restContainerProps = _objectWithoutProperties(_props$containerProps, _excluded6);\n\n  var layout = layoutOptions.layout;\n\n  var containerProps = _objectSpread({\n    className: \"react-photo-album react-photo-album--\".concat(layout),\n    style: _objectSpread({\n      display: \"flex\",\n      flexWrap: \"nowrap\",\n      justifyContent: \"space-between\",\n      flexDirection: layout === \"rows\" ? \"column\" : \"row\"\n    }, style)\n  }, restContainerProps);\n\n  if (renderContainer && typeof renderContainer === \"object\") {\n    var Component = renderContainer;\n    return jsx(Component, {\n      ref: containerRef,\n      layoutOptions: layoutOptions,\n      containerProps: containerProps,\n      children: children\n    });\n  }\n\n  return jsx(Fragment, {\n    children: (renderContainer !== null && renderContainer !== void 0 ? renderContainer : defaultRenderContainer)({\n      containerProps: containerProps,\n      containerRef: containerRef,\n      layoutOptions: layoutOptions,\n      children: children\n    })\n  });\n};\n\nvar useLayoutEffect = typeof window !== \"undefined\" ? useLayoutEffect$1 : useEffect;\n\nvar useEventCallback = function useEventCallback(fn) {\n  var ref = useRef(fn);\n  useLayoutEffect(function () {\n    ref.current = fn;\n  });\n  return useCallback(function () {\n    var _a2;\n\n    var _a;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return (_a = ref.current) === null || _a === void 0 ? void 0 : (_a2 = _a).call.apply(_a2, [ref].concat(args));\n  }, []);\n};\n\nvar useContainerWidth = function useContainerWidth(resizeObserverProvider, breakpoints) {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      containerWidth = _useState2[0],\n      setContainerWidth = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      scrollbarWidth = _useState4[0],\n      setScrollbarWidth = _useState4[1];\n\n  var ref = useRef(null);\n  var observerRef = useRef();\n  var updateWidth = useEventCallback(function () {\n    var _a;\n\n    var newWidth = (_a = ref.current) === null || _a === void 0 ? void 0 : _a.clientWidth;\n\n    if (newWidth !== undefined && breakpoints && breakpoints.length > 0) {\n      var sortedBreakpoints = _toConsumableArray(breakpoints.filter(function (x) {\n        return x > 0;\n      })).sort(function (a, b) {\n        return b - a;\n      });\n\n      sortedBreakpoints.push(Math.floor(sortedBreakpoints[sortedBreakpoints.length - 1] / 2));\n      var threshold = newWidth;\n      newWidth = sortedBreakpoints.find(function (breakpoint, index) {\n        return breakpoint <= threshold || index === sortedBreakpoints.length - 1;\n      });\n    }\n\n    var newScrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\n\n    if (newScrollbarWidth !== scrollbarWidth) {\n      setScrollbarWidth(newScrollbarWidth);\n    }\n\n    if (containerWidth !== undefined && scrollbarWidth !== undefined && newWidth !== undefined && newWidth > containerWidth && newWidth - containerWidth <= 20 && newScrollbarWidth < scrollbarWidth) {\n      return;\n    }\n\n    if (newWidth !== containerWidth) {\n      setContainerWidth(newWidth);\n    }\n  });\n  var containerRef = useEventCallback(function (node) {\n    var _a, _b;\n\n    (_a = observerRef.current) === null || _a === void 0 ? void 0 : _a.disconnect();\n    observerRef.current = undefined;\n    ref.current = node;\n    updateWidth();\n\n    if (node) {\n      observerRef.current = typeof ResizeObserver !== \"undefined\" ? new ResizeObserver(updateWidth) : resizeObserverProvider === null || resizeObserverProvider === void 0 ? void 0 : resizeObserverProvider(updateWidth);\n      (_b = observerRef.current) === null || _b === void 0 ? void 0 : _b.observe(node);\n    }\n  });\n  return {\n    containerRef: containerRef,\n    containerWidth: containerWidth\n  };\n};\n\nvar breakpoints = Object.freeze([1200, 600, 300, 0]);\n\nvar unwrap = function unwrap(value, containerWidth) {\n  return typeof value === \"function\" ? value(containerWidth) : value;\n};\n\nvar unwrapParameter = function unwrapParameter(value, containerWidth) {\n  return typeof value !== \"undefined\" ? unwrap(value, containerWidth) : undefined;\n};\n\nvar selectResponsiveValue = function selectResponsiveValue(values, containerWidth) {\n  var index = breakpoints.findIndex(function (breakpoint) {\n    return breakpoint <= containerWidth;\n  });\n  return unwrap(values[index >= 0 ? index : 0], containerWidth);\n};\n\nvar resolveResponsiveParameter = function resolveResponsiveParameter(parameter, containerWidth, values) {\n  var minValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n  var value = unwrapParameter(parameter, containerWidth);\n  return Math.round(Math.max(value === undefined ? selectResponsiveValue(values, containerWidth) : value, minValue));\n};\n\nvar resolveLayoutOptions = function resolveLayoutOptions(_ref26) {\n  var layout = _ref26.layout,\n      onClick = _ref26.onClick,\n      viewportWidth = _ref26.viewportWidth,\n      containerWidth = _ref26.containerWidth,\n      targetRowHeight = _ref26.targetRowHeight,\n      rowConstraints = _ref26.rowConstraints,\n      columnConstraints = _ref26.columnConstraints,\n      columns = _ref26.columns,\n      spacing = _ref26.spacing,\n      padding = _ref26.padding,\n      sizes = _ref26.sizes;\n  return {\n    layout: layout,\n    onClick: onClick,\n    viewportWidth: viewportWidth,\n    containerWidth: containerWidth,\n    columns: resolveResponsiveParameter(columns, containerWidth, [5, 4, 3, 2], 1),\n    spacing: resolveResponsiveParameter(spacing, containerWidth, [20, 15, 10, 5]),\n    padding: resolveResponsiveParameter(padding, containerWidth, [0, 0, 0, 0, 0]),\n    targetRowHeight: resolveResponsiveParameter(targetRowHeight, containerWidth, [function (w) {\n      return w / 5;\n    }, function (w) {\n      return w / 4;\n    }, function (w) {\n      return w / 3;\n    }, function (w) {\n      return w / 2;\n    }]),\n    rowConstraints: unwrapParameter(rowConstraints, containerWidth),\n    columnConstraints: unwrapParameter(columnConstraints, containerWidth),\n    sizes: sizes\n  };\n};\n\nvar resolveComponentsProps = function resolveComponentsProps(componentsProps, containerWidth) {\n  return typeof componentsProps === \"function\" ? componentsProps(containerWidth) : componentsProps;\n};\n\nvar PhotoAlbum = function PhotoAlbum(props) {\n  var photos = props.photos,\n      layout = props.layout,\n      renderPhoto = props.renderPhoto,\n      renderContainer = props.renderContainer,\n      renderRowContainer = props.renderRowContainer,\n      renderColumnContainer = props.renderColumnContainer,\n      defaultContainerWidth = props.defaultContainerWidth,\n      resizeObserverProvider = props.resizeObserverProvider,\n      breakpoints = props.breakpoints,\n      instrumentation = props.instrumentation;\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mounted = _useState6[0],\n      setMounted = _useState6[1];\n\n  var _useContainerWidth = useContainerWidth(resizeObserverProvider, breakpoints),\n      containerRef = _useContainerWidth.containerRef,\n      containerWidth = _useContainerWidth.containerWidth;\n\n  useLayoutEffect(function () {\n    return setMounted(true);\n  }, []);\n  if (!layout || ![\"rows\", \"columns\", \"masonry\"].includes(layout) || !Array.isArray(photos)) return jsx(Fragment, {});\n  var layoutOptions = resolveLayoutOptions(_objectSpread({\n    containerWidth: mounted && containerWidth || defaultContainerWidth || 800,\n    viewportWidth: mounted && window.innerWidth || undefined\n  }, props));\n  var componentsProps = resolveComponentsProps(props.componentsProps, layoutOptions.containerWidth);\n  var commonLayoutProps = {\n    photos: photos,\n    renderPhoto: renderPhoto,\n    componentsProps: componentsProps,\n    instrumentation: instrumentation\n  };\n  return jsx(ContainerRenderer, {\n    containerRef: containerRef,\n    layoutOptions: layoutOptions,\n    renderContainer: renderContainer,\n    containerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.containerProps,\n    children: layout === \"rows\" ? jsx(RowsLayout, _objectSpread({\n      layoutOptions: layoutOptions,\n      renderRowContainer: renderRowContainer\n    }, commonLayoutProps)) : layout === \"columns\" ? jsx(ColumnsLayout, _objectSpread({\n      layoutOptions: layoutOptions,\n      renderColumnContainer: renderColumnContainer\n    }, commonLayoutProps)) : jsx(MasonryLayout, _objectSpread({\n      layoutOptions: layoutOptions,\n      renderColumnContainer: renderColumnContainer\n    }, commonLayoutProps))\n  });\n};\n\nexport { PhotoAlbum, PhotoAlbum as default };","map":{"version":3,"names":["jsx","Fragment","useLayoutEffect","useLayoutEffect$1","useEffect","useRef","useCallback","useState","ratio","width","height","round","value","decimals","factor","Math","Number","EPSILON","RankingFunctionComparator","rank","a","b","MinHeap","comparator","heap","compare","n","greater","i","j","swap","temp","swim","k","k2","sink","push","element","pop","undefined","max","size","buildPrecedentsMap","graph","startNode","endNode","precedentsMap","visited","storedShortestPaths","pQueue","el","weight","id","shortestNode","shortestNodeId","neighboringNodes","neighbor","newTotalWeight","getPathFromPrecedentsMap","nodes","reverse","findShortestPath","findIdealNodeSearch","photos","targetRowHeight","containerWidth","minRatio","reduce","acc","photo","min","MAX_VALUE","getCommonHeight","row","spacing","padding","rowWidth","length","totalAspectRatio","cost","slice","commonHeight","makeGetNeighbors$1","layoutOptions","limitNodeSearch","rowConstraints","instrumentation","node","_a","_b","results","start","startOffset","minPhotos","endOffset","maxPhotos","Infinity","fullGraphSearch","currentCost","toString","computeRowsLayout","onStartLayoutComputation","call","getNeighbors","path","result","map","index","photoIndex","layout","photosCount","onFinishLayoutComputation","calcWidth","base","gaps","cssWidth$1","calculateSizesValue","match","srcSetAndSizes","srcSet","sizes","images","concat","src","sort","first","second","image","join","viewport","ceil","viewportWidth","PhotoRenderer","props","imageProps","style","restImageProps","renderPhoto","onClick","imageStyle","display","boxSizing","aspectRatio","marginBottom","cursor","handleClick","event","alt","title","className","renderDefaultPhoto","wrapped","rest","wrapperStyle","children","defaultRenderRowContainer","rowContainerProps","RowContainerRenderer","rowIndex","rowsCount","renderRowContainer","restRowContainerProps","flexDirection","flexWrap","alignItems","justifyContent","RowsLayout","componentsProps","rowsLayout","key","computeShortestPath","pathLength","comp","queue","Object","keys","forEach","accumulatedWeight","reconstructShortestPath","prevNode","findShortestPathLengthN","makeGetNeighbors","targetColumnWidth","targetColumnHeight","cutOffHeight","buildColumnsModel","columnsGaps","columnsRatios","columnsModel","totalRatio","column","totalAdjustedGaps","columnWidth","computeColumnsModel","columns","Array","from","_","columnConstraints","minColumns","computeLayout","findIndex","columnModel","computeColumnsLayout","_c","defaultRenderColumnContainer","columnContainerProps","cssWidth","columnIndex","columnsCount","ColumnContainerRenderer","renderColumnContainer","restColumnContainerProps","ColumnsLayout","columnsLayout","computeMasonryLayout","columnsCurrentTopPositions","shortestColumn","item","MasonryLayout","masonryLayout","defaultRenderContainer","containerProps","containerRef","ref","ContainerRenderer","renderContainer","restContainerProps","Component","window","useEventCallback","fn","current","args","useContainerWidth","resizeObserverProvider","breakpoints","setContainerWidth","scrollbarWidth","setScrollbarWidth","observerRef","updateWidth","newWidth","clientWidth","sortedBreakpoints","filter","x","floor","threshold","find","breakpoint","newScrollbarWidth","innerWidth","document","documentElement","disconnect","ResizeObserver","observe","freeze","unwrap","unwrapParameter","selectResponsiveValue","values","resolveResponsiveParameter","parameter","minValue","resolveLayoutOptions","w","resolveComponentsProps","PhotoAlbum","defaultContainerWidth","mounted","setMounted","includes","isArray","commonLayoutProps","default"],"sources":["/Users/kubilaybozak/Desktop/Tatto-Template/node_modules/react-photo-album/dist/index.esm.js"],"sourcesContent":["import { jsx, Fragment } from 'react/jsx-runtime';\nimport { useLayoutEffect as useLayoutEffect$1, useEffect, useRef, useCallback, useState } from 'react';\n\nconst ratio = ({ width, height }) => width / height;\n\nconst round = (value, decimals = 0) => {\r\n    const factor = 10 ** decimals;\r\n    return Math.round((value + Number.EPSILON) * factor) / factor;\r\n};\n\nconst RankingFunctionComparator = (rank) => (a, b) => rank(b) - rank(a);\r\nconst MinHeap = (comparator) => {\r\n    const heap = [];\r\n    const compare = comparator;\r\n    let n = 0;\r\n    const greater = (i, j) => compare(heap[i], heap[j]) < 0;\r\n    const swap = (i, j) => {\r\n        const temp = heap[i];\r\n        heap[i] = heap[j];\r\n        heap[j] = temp;\r\n    };\r\n    const swim = (k) => {\r\n        let k2 = k >> 1;\r\n        while (k > 1 && greater(k2, k)) {\r\n            swap(k2, k);\r\n            k = k2;\r\n            k2 = k >> 1;\r\n        }\r\n    };\r\n    const sink = (k) => {\r\n        let j = k << 1;\r\n        while (j <= n) {\r\n            if (j < n && greater(j, j + 1))\r\n                j++;\r\n            if (!greater(k, j))\r\n                break;\r\n            swap(k, j);\r\n            k = j;\r\n            j = k << 1;\r\n        }\r\n    };\r\n    return {\r\n        push: (element) => {\r\n            n += 1;\r\n            heap[n] = element;\r\n            swim(n);\r\n        },\r\n        pop: () => {\r\n            if (n === 0)\r\n                return undefined;\r\n            swap(1, n);\r\n            n -= 1;\r\n            const max = heap.pop();\r\n            sink(1);\r\n            return max;\r\n        },\r\n        size: () => n,\r\n    };\r\n};\n\nconst buildPrecedentsMap = (graph, startNode, endNode) => {\r\n    const precedentsMap = {};\r\n    const visited = {};\r\n    const storedShortestPaths = {};\r\n    storedShortestPaths[startNode] = 0;\r\n    const pQueue = MinHeap(RankingFunctionComparator((el) => el.weight));\r\n    pQueue.push({ id: startNode, weight: 0 });\r\n    let shortestNode;\r\n    while ((shortestNode = pQueue.pop()) !== undefined) {\r\n        const shortestNodeId = shortestNode.id;\r\n        if (visited[shortestNodeId])\r\n            continue;\r\n        const neighboringNodes = graph(shortestNodeId);\r\n        visited[shortestNodeId] = 1;\r\n        for (const neighbor in neighboringNodes) {\r\n            const newTotalWeight = shortestNode.weight + neighboringNodes[neighbor];\r\n            if (storedShortestPaths[neighbor] === undefined ||\r\n                (storedShortestPaths[neighbor] > newTotalWeight &&\r\n                    (storedShortestPaths[neighbor] / newTotalWeight > 1.005 ||\r\n                        precedentsMap[neighbor] < shortestNodeId))) {\r\n                storedShortestPaths[neighbor] = newTotalWeight;\r\n                pQueue.push({ id: neighbor, weight: newTotalWeight });\r\n                precedentsMap[neighbor] = shortestNodeId;\r\n            }\r\n        }\r\n    }\r\n    if (typeof storedShortestPaths[endNode] === \"undefined\") {\r\n        return undefined;\r\n    }\r\n    return precedentsMap;\r\n};\r\nconst getPathFromPrecedentsMap = (precedentsMap, endNode) => {\r\n    const nodes = [];\r\n    let n = endNode;\r\n    while (n) {\r\n        nodes.push(n);\r\n        n = precedentsMap[n];\r\n    }\r\n    return nodes.reverse();\r\n};\r\nconst findShortestPath = (graph, startNode, endNode) => {\r\n    const precedentsMap = buildPrecedentsMap(graph, startNode, endNode);\r\n    return precedentsMap !== undefined ? getPathFromPrecedentsMap(precedentsMap, endNode) : undefined;\r\n};\n\nconst findIdealNodeSearch = ({ photos, targetRowHeight, containerWidth, }) => {\r\n    const minRatio = photos.reduce((acc, photo) => Math.min(ratio(photo), acc), Number.MAX_VALUE);\r\n    return round(containerWidth / targetRowHeight / minRatio) + 2;\r\n};\r\nconst getCommonHeight = (row, containerWidth, spacing, padding) => {\r\n    const rowWidth = containerWidth - (row.length - 1) * spacing - 2 * padding * row.length;\r\n    const totalAspectRatio = row.reduce((acc, photo) => acc + ratio(photo), 0);\r\n    return rowWidth / totalAspectRatio;\r\n};\r\nconst cost = (photos, i, j, width, targetRowHeight, spacing, padding) => {\r\n    const row = photos.slice(i, j);\r\n    const commonHeight = getCommonHeight(row, width, spacing, padding);\r\n    return commonHeight > 0 ? (commonHeight - targetRowHeight) ** 2 * row.length : undefined;\r\n};\r\nconst makeGetNeighbors$1 = ({ photos, layoutOptions, targetRowHeight, limitNodeSearch, rowConstraints, instrumentation, }) => (node) => {\r\n    var _a, _b;\r\n    const { containerWidth, spacing, padding } = layoutOptions;\r\n    const results = {};\r\n    const start = +node;\r\n    results[+start] = 0;\r\n    const startOffset = (_a = rowConstraints === null || rowConstraints === void 0 ? void 0 : rowConstraints.minPhotos) !== null && _a !== void 0 ? _a : 1;\r\n    const endOffset = Math.min(limitNodeSearch, (_b = rowConstraints === null || rowConstraints === void 0 ? void 0 : rowConstraints.maxPhotos) !== null && _b !== void 0 ? _b : Infinity);\r\n    for (let i = start + startOffset; i < photos.length + 1; i += 1) {\r\n        if (i - start > endOffset && !(instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.fullGraphSearch))\r\n            break;\r\n        const currentCost = cost(photos, start, i, containerWidth, targetRowHeight, spacing, padding);\r\n        if (currentCost === undefined)\r\n            break;\r\n        results[i.toString()] = currentCost;\r\n    }\r\n    return results;\r\n};\r\nconst computeRowsLayout = ({ photos, layoutOptions, instrumentation, }) => {\r\n    var _a, _b;\r\n    const { spacing, padding, containerWidth, targetRowHeight, rowConstraints } = layoutOptions;\r\n    (_a = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _a === void 0 ? void 0 : _a.call(instrumentation);\r\n    const limitNodeSearch = findIdealNodeSearch({ photos, containerWidth, targetRowHeight });\r\n    const getNeighbors = makeGetNeighbors$1({\r\n        photos,\r\n        layoutOptions,\r\n        targetRowHeight,\r\n        limitNodeSearch,\r\n        rowConstraints,\r\n        instrumentation,\r\n    });\r\n    const path = findShortestPath(getNeighbors, \"0\", `${photos.length}`);\r\n    if (path === undefined)\r\n        return undefined;\r\n    const result = [];\r\n    for (let i = 1; i < path.length; i += 1) {\r\n        const row = photos.map((photo, index) => ({ photo, index })).slice(+path[i - 1], +path[i]);\r\n        const height = getCommonHeight(row.map(({ photo }) => photo), containerWidth, spacing, padding);\r\n        result.push(row.map(({ photo, index }, photoIndex) => ({\r\n            photo,\r\n            layout: {\r\n                height,\r\n                width: height * ratio(photo),\r\n                index,\r\n                photoIndex,\r\n                photosCount: row.length,\r\n            },\r\n        })));\r\n    }\r\n    (_b = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _b === void 0 ? void 0 : _b.call(instrumentation, result);\r\n    return result;\r\n};\n\nconst calcWidth = (base, { width, photosCount }, { spacing, padding, containerWidth }) => {\r\n    const gaps = spacing * (photosCount - 1) + 2 * padding * photosCount;\r\n    return `calc((${base} - ${gaps}px) / ${round((containerWidth - gaps) / width, 5)})`;\r\n};\r\nconst cssWidth$1 = (layout, layoutOptions) => {\r\n    if (layoutOptions.layout !== \"rows\") {\r\n        return `calc(100% - ${2 * layoutOptions.padding}px)`;\r\n    }\r\n    return calcWidth(\"100%\", layout, layoutOptions);\r\n};\r\nconst calculateSizesValue = (size, layout, layoutOptions) => { var _a, _b; return calcWidth((_b = (_a = size.match(/calc\\((.*)\\)/)) === null || _a === void 0 ? void 0 : _a[1]) !== null && _b !== void 0 ? _b : size, layout, layoutOptions); };\r\nconst srcSetAndSizes = (photo, layout, layoutOptions) => {\r\n    let srcSet, sizes;\r\n    if (photo.images && photo.images.length > 0) {\r\n        srcSet = photo.images\r\n            .concat([\r\n            {\r\n                src: photo.src,\r\n                width: photo.width,\r\n                height: photo.height,\r\n            },\r\n        ])\r\n            .sort((first, second) => first.width - second.width)\r\n            .map((image) => `${image.src} ${image.width}w`)\r\n            .join(\", \");\r\n    }\r\n    if (layoutOptions.sizes) {\r\n        sizes = (layoutOptions.sizes.sizes || [])\r\n            .map(({ viewport, size }) => `${viewport} ${calculateSizesValue(size, layout, layoutOptions)}`)\r\n            .concat(calculateSizesValue(layoutOptions.sizes.size, layout, layoutOptions))\r\n            .join(\", \");\r\n    }\r\n    else {\r\n        sizes = `${Math.ceil((layout.width / (layoutOptions.viewportWidth || layoutOptions.containerWidth)) * 100)}vw`;\r\n    }\r\n    return { srcSet, sizes };\r\n};\r\nconst PhotoRenderer = (props) => {\r\n    var _a, _b;\r\n    const { photo, layout, layoutOptions, imageProps: { style, ...restImageProps } = {}, renderPhoto } = props;\r\n    const { onClick } = layoutOptions;\r\n    const imageStyle = {\r\n        display: \"block\",\r\n        boxSizing: \"content-box\",\r\n        width: cssWidth$1(layout, layoutOptions),\r\n        height: \"auto\",\r\n        aspectRatio: `${photo.width} / ${photo.height}`,\r\n        ...(layoutOptions.padding ? { padding: `${layoutOptions.padding}px` } : null),\r\n        ...((layoutOptions.layout === \"columns\" || layoutOptions.layout === \"masonry\") &&\r\n            layout.photoIndex < layout.photosCount - 1\r\n            ? { marginBottom: `${layoutOptions.spacing}px` }\r\n            : null),\r\n        ...(onClick ? { cursor: \"pointer\" } : null),\r\n        ...style,\r\n    };\r\n    const handleClick = onClick\r\n        ? (event) => {\r\n            onClick(event, photo, layout.index);\r\n        }\r\n        : undefined;\r\n    const imageProps = {\r\n        src: photo.src,\r\n        alt: (_a = photo.alt) !== null && _a !== void 0 ? _a : \"\",\r\n        title: photo.title,\r\n        onClick: handleClick,\r\n        style: imageStyle,\r\n        className: \"react-photo-album--photo\",\r\n        ...srcSetAndSizes(photo, layout, layoutOptions),\r\n        ...restImageProps,\r\n    };\r\n    const renderDefaultPhoto = ({ wrapped } = {}) => {\r\n        const { src, alt, srcSet, sizes, style, ...rest } = imageProps;\r\n        return (jsx(\"img\", { alt: alt, ...(srcSet ? { srcSet, sizes } : null), src: src, style: wrapped ? { display: \"block\", width: \"100%\", height: \"100%\" } : style, ...rest }));\r\n    };\r\n    const wrapperStyle = (({ display, boxSizing, width, aspectRatio, padding, marginBottom }) => ({\r\n        display,\r\n        boxSizing,\r\n        width,\r\n        aspectRatio,\r\n        padding,\r\n        marginBottom,\r\n    }))(imageStyle);\r\n    return (jsx(Fragment, { children: (_b = renderPhoto === null || renderPhoto === void 0 ? void 0 : renderPhoto({\r\n            photo,\r\n            layout,\r\n            layoutOptions,\r\n            imageProps,\r\n            renderDefaultPhoto,\r\n            wrapperStyle,\r\n        })) !== null && _b !== void 0 ? _b : renderDefaultPhoto() }));\r\n};\n\nconst defaultRenderRowContainer = ({ rowContainerProps, children, }) => jsx(\"div\", { ...rowContainerProps, children: children });\r\nconst RowContainerRenderer = (props) => {\r\n    const { layoutOptions, rowIndex, rowsCount, renderRowContainer, rowContainerProps: { style, ...restRowContainerProps } = {}, children, } = props;\r\n    const rowContainerProps = {\r\n        className: \"react-photo-album--row\",\r\n        style: {\r\n            display: \"flex\",\r\n            flexDirection: \"row\",\r\n            flexWrap: \"nowrap\",\r\n            alignItems: \"flex-start\",\r\n            justifyContent: \"space-between\",\r\n            ...(rowIndex < rowsCount - 1 ? { marginBottom: `${layoutOptions.spacing}px` } : null),\r\n            ...style,\r\n        },\r\n        ...restRowContainerProps,\r\n    };\r\n    return (jsx(Fragment, { children: (renderRowContainer !== null && renderRowContainer !== void 0 ? renderRowContainer : defaultRenderRowContainer)({\r\n            layoutOptions,\r\n            rowIndex,\r\n            rowsCount,\r\n            rowContainerProps,\r\n            children,\r\n        }) }));\r\n};\n\nconst RowsLayout = (props) => {\r\n    const { photos, layoutOptions, renderPhoto, renderRowContainer, componentsProps, instrumentation } = props;\r\n    const rowsLayout = computeRowsLayout({ photos, layoutOptions, instrumentation });\r\n    if (rowsLayout === undefined)\r\n        return jsx(Fragment, {});\r\n    return (jsx(Fragment, { children: rowsLayout.map((row, rowIndex) => (jsx(RowContainerRenderer, { layoutOptions: layoutOptions, rowIndex: rowIndex, rowsCount: rowsLayout.length, renderRowContainer: renderRowContainer, rowContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.rowContainerProps, children: row.map(({ photo, layout }) => (jsx(PhotoRenderer, { photo: photo, layout: layout, layoutOptions: layoutOptions, renderPhoto: renderPhoto, imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps }, photo.key || photo.src))) }, `row-${rowIndex}`))) }));\r\n};\n\nconst computeShortestPath = (graph, pathLength, startNode, endNode) => {\r\n    const comp = [];\r\n    const queue = { 0: { [startNode]: null } };\r\n    for (let length = 0; length < pathLength; length += 1) {\r\n        Object.keys(queue[length]).forEach((n) => {\r\n            const node = +n;\r\n            const accumulatedWeight = length > 0 && comp[node][length] ? comp[node][length][1] : 0;\r\n            graph(node).forEach(({ neighbor, weight }) => {\r\n                if (!comp[neighbor]) {\r\n                    comp[neighbor] = [];\r\n                }\r\n                const newTotalWeight = accumulatedWeight + weight;\r\n                if (!comp[neighbor][length + 1] ||\r\n                    (comp[neighbor][length + 1][1] > newTotalWeight &&\r\n                        (comp[neighbor][length + 1][1] / newTotalWeight > 1.0001 ||\r\n                            node < comp[neighbor][length + 1][0]))) {\r\n                    comp[neighbor][length + 1] = [node, newTotalWeight];\r\n                }\r\n                if (length < pathLength - 1 && neighbor !== endNode) {\r\n                    if (!queue[length + 1]) {\r\n                        queue[length + 1] = {};\r\n                    }\r\n                    queue[length + 1][neighbor] = null;\r\n                }\r\n            });\r\n        });\r\n    }\r\n    return comp;\r\n};\r\nconst reconstructShortestPath = (comp, pathLength, endNode) => {\r\n    const path = [endNode];\r\n    for (let node = endNode, length = pathLength; length > 0; length -= 1) {\r\n        const [prevNode] = comp[node][length];\r\n        node = prevNode;\r\n        path.push(node);\r\n    }\r\n    return path.reverse();\r\n};\r\nconst findShortestPathLengthN = (graph, pathLength, startNode, endNode) => reconstructShortestPath(computeShortestPath(graph, pathLength, startNode, endNode), pathLength, endNode);\n\nconst makeGetNeighbors = ({ photos, spacing, padding, targetColumnWidth, targetColumnHeight, instrumentation, }) => (node) => {\r\n    const results = [];\r\n    const cutOffHeight = targetColumnHeight * 1.5;\r\n    let height = targetColumnWidth / ratio(photos[node]) + 2 * padding;\r\n    for (let i = node + 1; i < photos.length + 1; i += 1) {\r\n        results.push({ neighbor: i, weight: (targetColumnHeight - height) ** 2 });\r\n        if ((height > cutOffHeight && !(instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.fullGraphSearch)) || i === photos.length) {\r\n            break;\r\n        }\r\n        height += targetColumnWidth / ratio(photos[i]) + spacing + 2 * padding;\r\n    }\r\n    return results;\r\n};\r\nconst buildColumnsModel = ({ path, photos, containerWidth, columnsGaps, columnsRatios, spacing, padding, }) => {\r\n    const columnsModel = [];\r\n    const totalRatio = columnsRatios.reduce((acc, ratio) => acc + ratio, 0);\r\n    for (let i = 0; i < path.length - 1; i += 1) {\r\n        const column = photos.map((photo, index) => ({ photo, index })).slice(path[i], path[i + 1]);\r\n        const totalAdjustedGaps = columnsRatios.reduce((acc, ratio, index) => acc + (columnsGaps[i] - columnsGaps[index]) * ratio, 0);\r\n        const columnWidth = ((containerWidth - (path.length - 2) * spacing - 2 * (path.length - 1) * padding - totalAdjustedGaps) *\r\n            columnsRatios[i]) /\r\n            totalRatio;\r\n        columnsModel.push(column.map(({ photo, index }, photoIndex) => ({\r\n            photo,\r\n            layout: {\r\n                width: columnWidth,\r\n                height: columnWidth / ratio(photo),\r\n                index,\r\n                photoIndex,\r\n                photosCount: column.length,\r\n            },\r\n        })));\r\n    }\r\n    return columnsModel;\r\n};\r\nconst computeColumnsModel = ({ photos, layoutOptions, targetColumnWidth, instrumentation, }) => {\r\n    var _a;\r\n    const { columns, spacing, padding, containerWidth } = layoutOptions;\r\n    const columnsGaps = [];\r\n    const columnsRatios = [];\r\n    if (photos.length <= columns) {\r\n        for (let index = 0; index < photos.length; index += 1) {\r\n            columnsGaps[index] = 2 * padding;\r\n            columnsRatios[index] = ratio(photos[index]);\r\n        }\r\n        const columnsModel = buildColumnsModel({\r\n            path: Array.from({ length: photos.length + 1 }).map((_, index) => index),\r\n            photos,\r\n            columnsRatios,\r\n            columnsGaps,\r\n            containerWidth,\r\n            spacing,\r\n            padding,\r\n        });\r\n        for (let i = photos.length; i < (((_a = layoutOptions.columnConstraints) === null || _a === void 0 ? void 0 : _a.minColumns) || 0); i += 1) {\r\n            columnsGaps[i] = 0;\r\n            columnsRatios[i] =\r\n                photos.length > 0 ? photos.reduce((acc, photo) => acc + ratio(photo), 0) / photos.length : 1;\r\n            columnsModel[i] = [];\r\n        }\r\n        return { columnsGaps, columnsRatios, columnsModel };\r\n    }\r\n    const targetColumnHeight = (photos.reduce((acc, photo) => acc + targetColumnWidth / ratio(photo), 0) +\r\n        spacing * (photos.length - columns) +\r\n        2 * padding * photos.length) /\r\n        columns;\r\n    const getNeighbors = makeGetNeighbors({\r\n        photos,\r\n        targetColumnWidth,\r\n        targetColumnHeight,\r\n        spacing,\r\n        padding,\r\n        instrumentation,\r\n    });\r\n    const path = findShortestPathLengthN(getNeighbors, columns, 0, photos.length).map((node) => +node);\r\n    for (let i = 0; i < path.length - 1; i += 1) {\r\n        const column = photos.slice(path[i], path[i + 1]);\r\n        columnsGaps[i] = spacing * (column.length - 1) + 2 * padding * column.length;\r\n        columnsRatios[i] = 1 / column.reduce((acc, photo) => acc + 1 / ratio(photo), 0);\r\n    }\r\n    const columnsModel = buildColumnsModel({\r\n        path,\r\n        photos,\r\n        columnsRatios,\r\n        columnsGaps,\r\n        containerWidth,\r\n        spacing,\r\n        padding,\r\n    });\r\n    return { columnsGaps, columnsRatios, columnsModel };\r\n};\r\nconst computeLayout = (props) => {\r\n    const { photos, layoutOptions, instrumentation } = props;\r\n    const { columns, spacing, padding, containerWidth } = layoutOptions;\r\n    const targetColumnWidth = (containerWidth - spacing * (columns - 1) - 2 * padding * columns) / columns;\r\n    const { columnsGaps, columnsRatios, columnsModel } = computeColumnsModel({\r\n        photos,\r\n        layoutOptions,\r\n        targetColumnWidth,\r\n        instrumentation,\r\n    });\r\n    if (columnsModel.findIndex((columnModel) => columnModel.findIndex(({ layout: { width, height } }) => width < 0 || height < 0) >= 0) >= 0) {\r\n        if (columns > 1) {\r\n            return computeLayout({\r\n                photos,\r\n                layoutOptions: {\r\n                    ...layoutOptions,\r\n                    columns: columns - 1,\r\n                },\r\n                instrumentation,\r\n            });\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n    return { columnsModel, columnsGaps, columnsRatios };\r\n};\r\nconst computeColumnsLayout = ({ photos, layoutOptions, instrumentation, }) => {\r\n    var _a, _b, _c;\r\n    (_a = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _a === void 0 ? void 0 : _a.call(instrumentation);\r\n    const result = computeLayout({\r\n        photos,\r\n        layoutOptions: {\r\n            ...layoutOptions,\r\n            columns: Math.min(layoutOptions.columns, Math.max(photos.length, ((_b = layoutOptions.columnConstraints) === null || _b === void 0 ? void 0 : _b.minColumns) || 0)),\r\n        },\r\n        instrumentation,\r\n    });\r\n    (_c = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _c === void 0 ? void 0 : _c.call(instrumentation, result);\r\n    return result;\r\n};\n\nconst defaultRenderColumnContainer = ({ columnContainerProps, children, }) => jsx(\"div\", { ...columnContainerProps, children: children });\r\nconst cssWidth = (props) => {\r\n    const { layoutOptions, columnIndex, columnsCount, columnsGaps, columnsRatios } = props;\r\n    const { layout, spacing, padding } = layoutOptions;\r\n    if (layout === \"masonry\" || !columnsGaps || !columnsRatios) {\r\n        return `calc((100% - ${spacing * (columnsCount - 1)}px) / ${columnsCount})`;\r\n    }\r\n    const totalRatio = columnsRatios.reduce((acc, ratio) => acc + ratio, 0);\r\n    const totalAdjustedGaps = columnsRatios.reduce((acc, ratio, index) => acc + (columnsGaps[columnIndex] - columnsGaps[index]) * ratio, 0);\r\n    return `calc((100% - ${round((columnsCount - 1) * spacing + 2 * columnsCount * padding + totalAdjustedGaps, 3)}px) * ${round(columnsRatios[columnIndex] / totalRatio, 5)} + ${2 * padding}px)`;\r\n};\r\nconst ColumnContainerRenderer = (props) => {\r\n    const { layoutOptions, renderColumnContainer, children, columnContainerProps: { style, ...restColumnContainerProps } = {}, ...rest } = props;\r\n    const columnContainerProps = {\r\n        className: \"react-photo-album--column\",\r\n        style: {\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            flexWrap: \"nowrap\",\r\n            alignItems: \"flex-start\",\r\n            width: cssWidth(props),\r\n            justifyContent: layoutOptions.layout === \"columns\" ? \"space-between\" : \"flex-start\",\r\n            ...style,\r\n        },\r\n        ...restColumnContainerProps,\r\n    };\r\n    return (jsx(Fragment, { children: (renderColumnContainer !== null && renderColumnContainer !== void 0 ? renderColumnContainer : defaultRenderColumnContainer)({\r\n            layoutOptions,\r\n            columnContainerProps,\r\n            children,\r\n            ...rest,\r\n        }) }));\r\n};\n\nconst ColumnsLayout = (props) => {\r\n    const { photos, layoutOptions, renderPhoto, renderColumnContainer, componentsProps, instrumentation } = props;\r\n    const columnsLayout = computeColumnsLayout({ photos, layoutOptions, instrumentation });\r\n    if (columnsLayout === undefined)\r\n        return jsx(Fragment, {});\r\n    const { columnsModel, columnsRatios, columnsGaps } = columnsLayout;\r\n    return (jsx(Fragment, { children: columnsModel.map((column, columnIndex) => (jsx(ColumnContainerRenderer, { layoutOptions: layoutOptions, columnIndex: columnIndex, columnsCount: columnsModel.length, columnsGaps: columnsGaps, columnsRatios: columnsRatios, renderColumnContainer: renderColumnContainer, columnContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.columnContainerProps, children: column.map(({ photo, layout }) => (jsx(PhotoRenderer, { photo: photo, layout: layout, layoutOptions: layoutOptions, renderPhoto: renderPhoto, imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps }, photo.key || photo.src))) }, `column-${columnIndex}`))) }));\r\n};\n\nconst computeMasonryLayout = (props) => {\r\n    var _a, _b, _c;\r\n    const { photos, layoutOptions, instrumentation } = props;\r\n    const { spacing, padding, containerWidth } = layoutOptions;\r\n    const columns = Math.min(layoutOptions.columns, Math.max(photos.length, ((_a = layoutOptions.columnConstraints) === null || _a === void 0 ? void 0 : _a.minColumns) || 0));\r\n    (_b = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onStartLayoutComputation) === null || _b === void 0 ? void 0 : _b.call(instrumentation);\r\n    const columnWidth = (containerWidth - spacing * (columns - 1) - 2 * padding * columns) / columns;\r\n    if (columnWidth <= 0) {\r\n        return columns > 1\r\n            ? computeMasonryLayout({\r\n                ...props,\r\n                layoutOptions: { ...layoutOptions, columns: columns - 1 },\r\n            })\r\n            : undefined;\r\n    }\r\n    const columnsCurrentTopPositions = [];\r\n    for (let i = 0; i < columns; i += 1) {\r\n        columnsCurrentTopPositions[i] = 0;\r\n    }\r\n    const columnsModel = photos.reduce((acc, photo, index) => {\r\n        const shortestColumn = columnsCurrentTopPositions.reduce((acc, item, i) => item < columnsCurrentTopPositions[acc] - 1 ? i : acc, 0);\r\n        columnsCurrentTopPositions[shortestColumn] =\r\n            columnsCurrentTopPositions[shortestColumn] + columnWidth / ratio(photo) + spacing + 2 * padding;\r\n        acc[shortestColumn].push({ photo, index });\r\n        return acc;\r\n    }, Array.from({ length: columns }).map(() => []));\r\n    const result = columnsModel.map((column) => column.map(({ photo, index }, photoIndex) => ({\r\n        photo,\r\n        layout: {\r\n            width: columnWidth,\r\n            height: columnWidth / ratio(photo),\r\n            index,\r\n            photoIndex,\r\n            photosCount: column.length,\r\n        },\r\n    })));\r\n    (_c = instrumentation === null || instrumentation === void 0 ? void 0 : instrumentation.onFinishLayoutComputation) === null || _c === void 0 ? void 0 : _c.call(instrumentation, result);\r\n    return result;\r\n};\n\nconst MasonryLayout = (props) => {\r\n    const { photos, layoutOptions, renderPhoto, renderColumnContainer, componentsProps, instrumentation } = props;\r\n    const masonryLayout = computeMasonryLayout({ photos, layoutOptions, instrumentation });\r\n    if (masonryLayout === undefined)\r\n        return jsx(Fragment, {});\r\n    return (jsx(Fragment, { children: masonryLayout.map((column, columnIndex) => (jsx(ColumnContainerRenderer, { layoutOptions: layoutOptions, columnsCount: masonryLayout.length, columnIndex: columnIndex, renderColumnContainer: renderColumnContainer, columnContainerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.columnContainerProps, children: column.map(({ photo, layout }) => (jsx(PhotoRenderer, { photo: photo, layout: layout, layoutOptions: layoutOptions, renderPhoto: renderPhoto, imageProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.imageProps }, photo.key || photo.src))) }, `masonry-column-${columnIndex}`))) }));\r\n};\n\nconst defaultRenderContainer = ({ containerProps, children, containerRef, }) => (jsx(\"div\", { ref: containerRef, ...containerProps, children: children }));\r\nconst ContainerRenderer = (props) => {\r\n    const { layoutOptions, renderContainer, children, containerRef, containerProps: { style, ...restContainerProps } = {}, } = props;\r\n    const { layout } = layoutOptions;\r\n    const containerProps = {\r\n        className: `react-photo-album react-photo-album--${layout}`,\r\n        style: {\r\n            display: \"flex\",\r\n            flexWrap: \"nowrap\",\r\n            justifyContent: \"space-between\",\r\n            flexDirection: layout === \"rows\" ? \"column\" : \"row\",\r\n            ...style,\r\n        },\r\n        ...restContainerProps,\r\n    };\r\n    if (renderContainer && typeof renderContainer === \"object\") {\r\n        const Component = renderContainer;\r\n        return (jsx(Component, { ref: containerRef, layoutOptions: layoutOptions, containerProps: containerProps, children: children }));\r\n    }\r\n    return (jsx(Fragment, { children: (renderContainer !== null && renderContainer !== void 0 ? renderContainer : defaultRenderContainer)({\r\n            containerProps,\r\n            containerRef,\r\n            layoutOptions,\r\n            children,\r\n        }) }));\r\n};\n\nconst useLayoutEffect = typeof window !== \"undefined\" ? useLayoutEffect$1 : useEffect;\n\nconst useEventCallback = (fn) => {\r\n    const ref = useRef(fn);\r\n    useLayoutEffect(() => {\r\n        ref.current = fn;\r\n    });\r\n    return useCallback((...args) => { var _a; return (_a = ref.current) === null || _a === void 0 ? void 0 : _a.call(ref, ...args); }, []);\r\n};\n\nconst useContainerWidth = (resizeObserverProvider, breakpoints) => {\r\n    const [containerWidth, setContainerWidth] = useState();\r\n    const [scrollbarWidth, setScrollbarWidth] = useState();\r\n    const ref = useRef(null);\r\n    const observerRef = useRef();\r\n    const updateWidth = useEventCallback(() => {\r\n        var _a;\r\n        let newWidth = (_a = ref.current) === null || _a === void 0 ? void 0 : _a.clientWidth;\r\n        if (newWidth !== undefined && breakpoints && breakpoints.length > 0) {\r\n            const sortedBreakpoints = [...breakpoints.filter((x) => x > 0)].sort((a, b) => b - a);\r\n            sortedBreakpoints.push(Math.floor(sortedBreakpoints[sortedBreakpoints.length - 1] / 2));\r\n            const threshold = newWidth;\r\n            newWidth = sortedBreakpoints.find((breakpoint, index) => breakpoint <= threshold || index === sortedBreakpoints.length - 1);\r\n        }\r\n        const newScrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\r\n        if (newScrollbarWidth !== scrollbarWidth) {\r\n            setScrollbarWidth(newScrollbarWidth);\r\n        }\r\n        if (containerWidth !== undefined &&\r\n            scrollbarWidth !== undefined &&\r\n            newWidth !== undefined &&\r\n            newWidth > containerWidth &&\r\n            newWidth - containerWidth <= 20 &&\r\n            newScrollbarWidth < scrollbarWidth) {\r\n            return;\r\n        }\r\n        if (newWidth !== containerWidth) {\r\n            setContainerWidth(newWidth);\r\n        }\r\n    });\r\n    const containerRef = useEventCallback((node) => {\r\n        var _a, _b;\r\n        (_a = observerRef.current) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n        observerRef.current = undefined;\r\n        ref.current = node;\r\n        updateWidth();\r\n        if (node) {\r\n            observerRef.current =\r\n                typeof ResizeObserver !== \"undefined\"\r\n                    ? new ResizeObserver(updateWidth)\r\n                    : resizeObserverProvider === null || resizeObserverProvider === void 0 ? void 0 : resizeObserverProvider(updateWidth);\r\n            (_b = observerRef.current) === null || _b === void 0 ? void 0 : _b.observe(node);\r\n        }\r\n    });\r\n    return { containerRef, containerWidth };\r\n};\n\nconst breakpoints = Object.freeze([1200, 600, 300, 0]);\r\nconst unwrap = (value, containerWidth) => typeof value === \"function\" ? value(containerWidth) : value;\r\nconst unwrapParameter = (value, containerWidth) => typeof value !== \"undefined\" ? unwrap(value, containerWidth) : undefined;\r\nconst selectResponsiveValue = (values, containerWidth) => {\r\n    const index = breakpoints.findIndex((breakpoint) => breakpoint <= containerWidth);\r\n    return unwrap(values[index >= 0 ? index : 0], containerWidth);\r\n};\r\nconst resolveResponsiveParameter = (parameter, containerWidth, values, minValue = 0) => {\r\n    const value = unwrapParameter(parameter, containerWidth);\r\n    return Math.round(Math.max(value === undefined ? selectResponsiveValue(values, containerWidth) : value, minValue));\r\n};\n\nconst resolveLayoutOptions = ({ layout, onClick, viewportWidth, containerWidth, targetRowHeight, rowConstraints, columnConstraints, columns, spacing, padding, sizes, }) => ({\r\n    layout,\r\n    onClick,\r\n    viewportWidth,\r\n    containerWidth,\r\n    columns: resolveResponsiveParameter(columns, containerWidth, [5, 4, 3, 2], 1),\r\n    spacing: resolveResponsiveParameter(spacing, containerWidth, [20, 15, 10, 5]),\r\n    padding: resolveResponsiveParameter(padding, containerWidth, [0, 0, 0, 0, 0]),\r\n    targetRowHeight: resolveResponsiveParameter(targetRowHeight, containerWidth, [\r\n        (w) => w / 5,\r\n        (w) => w / 4,\r\n        (w) => w / 3,\r\n        (w) => w / 2,\r\n    ]),\r\n    rowConstraints: unwrapParameter(rowConstraints, containerWidth),\r\n    columnConstraints: unwrapParameter(columnConstraints, containerWidth),\r\n    sizes,\r\n});\r\nconst resolveComponentsProps = (componentsProps, containerWidth) => typeof componentsProps === \"function\" ? componentsProps(containerWidth) : componentsProps;\r\nconst PhotoAlbum = (props) => {\r\n    const { photos, layout, renderPhoto, renderContainer, renderRowContainer, renderColumnContainer, defaultContainerWidth, resizeObserverProvider, breakpoints, instrumentation, } = props;\r\n    const [mounted, setMounted] = useState(false);\r\n    const { containerRef, containerWidth } = useContainerWidth(resizeObserverProvider, breakpoints);\r\n    useLayoutEffect(() => setMounted(true), []);\r\n    if (!layout || ![\"rows\", \"columns\", \"masonry\"].includes(layout) || !Array.isArray(photos))\r\n        return jsx(Fragment, {});\r\n    const layoutOptions = resolveLayoutOptions({\r\n        containerWidth: (mounted && containerWidth) || defaultContainerWidth || 800,\r\n        viewportWidth: (mounted && window.innerWidth) || undefined,\r\n        ...props,\r\n    });\r\n    const componentsProps = resolveComponentsProps(props.componentsProps, layoutOptions.containerWidth);\r\n    const commonLayoutProps = { photos, renderPhoto, componentsProps, instrumentation };\r\n    return (jsx(ContainerRenderer, { containerRef: containerRef, layoutOptions: layoutOptions, renderContainer: renderContainer, containerProps: componentsProps === null || componentsProps === void 0 ? void 0 : componentsProps.containerProps, children: layout === \"rows\" ? (jsx(RowsLayout, { layoutOptions: layoutOptions, renderRowContainer: renderRowContainer, ...commonLayoutProps })) : layout === \"columns\" ? (jsx(ColumnsLayout, { layoutOptions: layoutOptions, renderColumnContainer: renderColumnContainer, ...commonLayoutProps })) : (jsx(MasonryLayout, { layoutOptions: layoutOptions, renderColumnContainer: renderColumnContainer, ...commonLayoutProps })) }));\r\n};\n\nexport { PhotoAlbum, PhotoAlbum as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}